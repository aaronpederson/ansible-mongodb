---
dependencies:
  - role: meta/repository
    repository_key: '0x9ecbec467f0ceb10'
    repository_url: 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen'
  - role: meta/monitor
    monitor_name: mongodb
    monitor_pidfile: "{{ mongodb_pidfile_path }}"
    monitor_user: "{{ mongodb_user }}"
    when: mongodb_server

  - role: package/fluentd
    fluentd_sources:
      - path: "{{ mongodb_log_path }}"
        format: '^(?<date_time>(?<date>[^T]*)T(?<time>[^\+]*)\+(?<time_offset>\d{4})) \[(?<placeholder_name>[^]]*)\] (?<message>.*)'
        tag: mongodb.service

  - role: package/logrotate
    logrotate_name: mongodb
